# GitPod Configuration for MongoDB AI Hub Auto-Launch
image: gitpod/workspace-mongodb

# Tasks that run on workspace startup
tasks:
  - name: MongoDB Setup
    init: |
      echo "ðŸ”§ Setting up MongoDB..."
      mkdir -p /workspace/data/db
    command: |
      echo "ðŸ“¦ Starting MongoDB..."
      mongod --dbpath /workspace/data/db --nojournal --fork --logpath /workspace/mongodb.log
      echo "âœ… MongoDB started"
  
  - name: AI Hub Server
    init: |
      echo "ðŸ“¦ Installing dependencies..."
      npm install
      echo "ðŸ”‘ Setting up environment..."
      if [ ! -f .env ]; then
        cp .env .env.backup 2>/dev/null || true
        echo "MONGODB_URI=mongodb://localhost:27017/mongodb-ai-hub-gitpod" >> .env
        echo "NODE_ENV=development" >> .env
      fi
    command: |
      echo "ðŸš€ Starting MongoDB AI Hub..."
      npm run dev
    openMode: split-right

# Ports to expose
ports:
  - port: 3000
    onOpen: notify
    name: MongoDB AI Hub API
    description: Main API server for AI Hub
  - port: 27017
    onOpen: ignore
    name: MongoDB Database

# VS Code extensions to install
vscode:
  extensions:
    - mongodb.mongodb-vscode
    - ms-vscode.vscode-json
    - ms-vscode.rest-client
    - bradlc.vscode-tailwindcss

# GitHub integration
github:
  prebuilds:
    master: true
    branches: true
    pullRequests: true